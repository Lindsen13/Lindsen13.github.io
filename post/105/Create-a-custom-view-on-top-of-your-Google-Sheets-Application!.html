<!DOCTYPE html>
<html lang="en">
 

<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-149203155-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-149203155-2');
    </script>
    <!-- Favicons -->

    <link href="/static/img/favicon/android-chrome-512x512.png" rel="icon">
    <link href="/static/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="/static/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/vendor/markdown-converter/styles.css" rel="stylesheet">

    <link href="/static/vendor/icofont/icofont.min.css" rel="stylesheet">
    <link href="/static/vendor/aos/aos.css" rel="stylesheet">
    <link href="/static/vendor/line-awesome/css/line-awesome.min.css" rel="stylesheet">
    <link href="/static/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Template Main CSS File -->
    <link href="/static/css/style.css" rel="stylesheet">

    <meta name="robots" content="index, follow">

    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport"> 
<title>Python Everything - Create a custom view on top of your Google Sheets Application!</title>
<meta name="description" content="Using Flask, Google Sheets and Yahoo Finance to create a custom web page for your Investment portfolio! - In this post, I will continue on the data which we collected &lt;a href=&#34;https:/..."> 
</head>

<body>

    <!-- ======= Mobile Menu ======= -->
    <div class="site-mobile-menu site-navbar-target">
        <div class="site-mobile-menu-header">
            <div class="site-mobile-menu-close mt-3">
                <span class="icofont-close js-menu-toggle"></span>
            </div>
        </div>
        <div class="site-mobile-menu-body"></div>
    </div>

    <!-- ======= Header ======= -->
    <header class="site-navbar js-sticky-header site-navbar-target" role="banner">

        <div class="container">
            <div class="row align-items-center">

                <div class="col-6 col-lg-2">
                    <h1 class="mb-0 site-logo"><a href="/" class="mb-0">Python Everything</a></h1>
                </div>

                <div class="col-12 col-md-10 d-none d-lg-block">
                    <nav class="site-navigation position-relative text-right" role="navigation">

                        <ul class="site-menu main-menu js-clone-nav mr-auto d-none d-lg-block">
                            <li class="active"><a href="/" class="nav-link">Home</a></li>
                            <li><a href="/explore/1.html" class="nav-link">Explore</a></li>
                            <li><a href="/authors.html" class="nav-link">Collaborators</a></li>
                            <li><a href="/#contact" class="nav-link">Get in touch</a></li>
                        </ul>
                    </nav>
                </div>

                <div class="col-6 d-inline-block d-lg-none ml-md-0 py-3" style="position: relative; top: 3px;">

                    <a href="#" class="burger site-menu-toggle js-menu-toggle" data-toggle="collapse" data-target="#main-navbar">
                        <span></span>
                    </a>
                </div>

            </div>
        </div>

    </header>

    

<main id="main">

    <section class="hero-section inner-page">
        <div class="wave">

            <svg width="1920px" height="265px" viewBox="0 0 1920 265" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <g id="Apple-TV" transform="translate(0.000000, -402.000000)" fill="#FFFFFF">
              <path d="M0,439.134243 C175.04074,464.89273 327.944386,477.771974 458.710937,477.771974 C654.860765,477.771974 870.645295,442.632362 1205.9828,410.192501 C1429.54114,388.565926 1667.54687,411.092417 1920,477.771974 L1920,667 L1017.15166,667 L0,667 L0,439.134243 Z" id="Path"></path>
            </g>
          </g>
        </svg>

        </div>

        <div class="container">
            <div class="row align-items-center">
                <div class="col-12">
                    <div class="row justify-content-center">
                        <div class="col-md-10 text-center hero-text">
                            <h1 data-aos="fade-up" data-aos-delay=""><h1>Create a custom view on top of your Google Sheets Application!</h1></h1>
                            <p class="mb-5" data-aos="fade-up" data-aos-delay="100">2020-08-30 &bullet; By <a href="#" class="text-white">Ivo</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </section>

    <section class="site-section mb-4">
        <div class="container">
            <div class="row">
                <div class="col-md-8 blog-content">

                    <p class="lead mb-5"><p>Using <strong>Flask</strong>, <strong>Google Sheets</strong> and <strong>Yahoo Finance</strong> to create a custom web page for your <strong>Investment portfolio</strong>!</p></p>
                    <p><p>In this post, I will continue on the data which we collected <a href="https://python-everything.com/post/95/A-customised-application-to-track-your-investments%21.html">last time</a>. It is a Google Sheet with my current investment portfolio. We made a script, that allows us to update the current value of all the assets, and therefore we know if we are making profit on our investments. </p>
<p>having a sheet for this is quite nice, but a custom build webpage would look much better! Just as in my <a href="https://python-everything.com/post/74/Making-a-custom-Reddit-application.html">Reddit Application</a> blogpost, I will make a simple Flask application that <a href="/examples/investment-application.html">showcases the data in a bootstrap template</a></p>
<p>Our folder will look as following:</p>
<div class="codehilite"><pre><span></span><code><span class="err">app</span>
<span class="err">├── env</span>
<span class="err">│   └── ...</span>
<span class="err">├── static</span>
<span class="err">│   └── style.scc</span>
<span class="err">├── templates</span>
<span class="err">│   └── index.html</span>
<span class="err">└── script.py</span>
</code></pre></div>


<p>So let's get started with this!</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># create a directory called &#39;app&#39;</span>
mkdir app
<span class="c1"># Navigate into the directory</span>
<span class="nb">cd</span> app
<span class="c1"># Create a virtual environment</span>
python3 -m venv env
<span class="c1"># Activate the virtual environment</span>
<span class="nb">source</span> env/bin/activate
<span class="c1"># Install the &#39;Flask&#39; package.</span>
pip install flask
<span class="c1"># Install the &#39;gspread&#39; package.</span>
pip install gspread
<span class="c1"># Install the &#39;oauth2client&#39; package.</span>
pip install oauth2client
<span class="c1"># Create a python file for the script</span>
touch script.py
<span class="c1"># Create a directory for our css files:</span>
mkdir static
touch static/style.css
<span class="c1"># Create a directory for our html templates:</span>
mkdir templates
touch templates/index.html
</code></pre></div>


<p>We will use some templates found at <a href="https://www.bootdey.com/">Bootydev</a>. After some adjustments, I am left with the following 2 files:</p>
<h2>The static/style.css file:</h2>
<div class="codehilite"><pre><span></span><code><span class="nt">body</span> <span class="p">{</span>
    <span class="k">background</span><span class="p">:</span> <span class="mh">#eee</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">main-box</span><span class="p">.</span><span class="nc">no-header</span> <span class="p">{</span>
    <span class="k">padding-top</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">main-box</span> <span class="p">{</span>
    <span class="k">background</span><span class="p">:</span> <span class="mh">#FFFFFF</span><span class="p">;</span>
    <span class="kp">-webkit-</span><span class="k">box-shadow</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="mi">1</span><span class="kt">px</span> <span class="mi">2</span><span class="kt">px</span> <span class="mi">0</span> <span class="mh">#CCCCCC</span><span class="p">;</span>
    <span class="kp">-moz-</span><span class="k">box-shadow</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="mi">1</span><span class="kt">px</span> <span class="mi">2</span><span class="kt">px</span> <span class="mi">0</span> <span class="mh">#CCCCCC</span><span class="p">;</span>
    <span class="kp">-o-</span><span class="k">box-shadow</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="mi">1</span><span class="kt">px</span> <span class="mi">2</span><span class="kt">px</span> <span class="mi">0</span> <span class="mh">#CCCCCC</span><span class="p">;</span>
    <span class="kp">-ms-</span><span class="k">box-shadow</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="mi">1</span><span class="kt">px</span> <span class="mi">2</span><span class="kt">px</span> <span class="mi">0</span> <span class="mh">#CCCCCC</span><span class="p">;</span>
    <span class="k">box-shadow</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="mi">1</span><span class="kt">px</span> <span class="mi">2</span><span class="kt">px</span> <span class="mi">0</span> <span class="mh">#CCCCCC</span><span class="p">;</span>
    <span class="k">margin-bottom</span><span class="p">:</span> <span class="mi">16</span><span class="kt">px</span><span class="p">;</span>
    <span class="err">-</span><span class="n">webikt-border-radius</span><span class="p">:</span> <span class="mi">3</span><span class="kt">px</span><span class="p">;</span>
    <span class="kp">-moz-</span><span class="k">border-radius</span><span class="p">:</span> <span class="mi">3</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">border-radius</span><span class="p">:</span> <span class="mi">3</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">table</span> <span class="nt">a</span><span class="p">.</span><span class="nc">table-link</span><span class="p">.</span><span class="nc">danger</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#e74c3c</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">label</span> <span class="p">{</span>
    <span class="k">border-radius</span><span class="p">:</span> <span class="mi">3</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">font-size</span><span class="p">:</span> <span class="mf">0.875</span><span class="kt">em</span><span class="p">;</span>
    <span class="k">font-weight</span><span class="p">:</span> <span class="mi">600</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">user-list</span> <span class="nt">tbody</span> <span class="nt">td</span> <span class="p">.</span><span class="nc">user-subhead</span> <span class="p">{</span>
    <span class="k">font-size</span><span class="p">:</span> <span class="mf">0.875</span><span class="kt">em</span><span class="p">;</span>
    <span class="k">font-style</span><span class="p">:</span> <span class="kc">italic</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">user-list</span> <span class="nt">tbody</span> <span class="nt">td</span> <span class="p">.</span><span class="nc">user-link</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="kc">block</span><span class="p">;</span>
    <span class="k">font-size</span><span class="p">:</span> <span class="mf">1.25</span><span class="kt">em</span><span class="p">;</span>
    <span class="k">padding-top</span><span class="p">:</span> <span class="mi">3</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">margin-left</span><span class="p">:</span> <span class="mi">60</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">a</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#3498db</span><span class="p">;</span>
    <span class="k">outline</span><span class="p">:</span> <span class="kc">none</span><span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">user-list</span> <span class="nt">tbody</span> <span class="nt">td</span><span class="o">&gt;</span><span class="nt">img</span> <span class="p">{</span>
    <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span>
    <span class="k">max-width</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
    <span class="k">margin-right</span><span class="p">:</span> <span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">table</span> <span class="nt">thead</span> <span class="nt">tr</span> <span class="nt">th</span> <span class="p">{</span>
    <span class="k">text-transform</span><span class="p">:</span> <span class="kc">uppercase</span><span class="p">;</span>
    <span class="k">font-size</span><span class="p">:</span> <span class="mf">0.875</span><span class="kt">em</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">table</span> <span class="nt">thead</span> <span class="nt">tr</span> <span class="nt">th</span> <span class="p">{</span>
    <span class="k">border-bottom</span><span class="p">:</span> <span class="mi">2</span><span class="kt">px</span> <span class="kc">solid</span> <span class="mh">#e7ebee</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">table</span> <span class="nt">tbody</span> <span class="nt">tr</span> <span class="nt">td</span><span class="p">:</span><span class="nd">first-child</span> <span class="p">{</span>
    <span class="k">font-size</span><span class="p">:</span> <span class="mf">1.125</span><span class="kt">em</span><span class="p">;</span>
    <span class="k">font-weight</span><span class="p">:</span> <span class="mi">300</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">table</span> <span class="nt">tbody</span> <span class="nt">tr</span> <span class="nt">td</span> <span class="p">{</span>
    <span class="k">font-size</span><span class="p">:</span> <span class="mf">0.875</span><span class="kt">em</span><span class="p">;</span>
    <span class="k">vertical-align</span><span class="p">:</span> <span class="kc">middle</span><span class="p">;</span>
    <span class="k">border-top</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="mh">#e7ebee</span><span class="p">;</span>
    <span class="k">padding</span><span class="p">:</span> <span class="mi">12</span><span class="kt">px</span> <span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>


<h2>And the templates/index.html file:</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">&gt;</span>
    <span class="c">&lt;!--  This file has been downloaded from bootdey.com    @bootdey on twitter --&gt;</span>
    <span class="c">&lt;!--  All snippets are MIT license http://bootdey.com/license --&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>table user list - Bootdey.com<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;http://netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;static&#39;, filename=&#39;style.css&#39;) }}&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container bootstrap snippets bootdey&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-lg-12&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;main-box no-header clearfix&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;main-box-body clearfix&quot;</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;table-responsive&quot;</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">table</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;table user-list&quot;</span><span class="p">&gt;</span>
                                <span class="p">&lt;</span><span class="nt">thead</span><span class="p">&gt;</span>
                                    <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">span</span><span class="p">&gt;</span>Stock<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">span</span><span class="p">&gt;</span>Bought At<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">span</span><span class="p">&gt;</span>Quantity<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">span</span><span class="p">&gt;</span>Status<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">span</span><span class="p">&gt;</span>Current Value each<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">span</span><span class="p">&gt;</span>Current Value total<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">span</span><span class="p">&gt;</span>Profit<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
                                    <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
                                <span class="p">&lt;/</span><span class="nt">thead</span><span class="p">&gt;</span>
                                <span class="p">&lt;</span><span class="nt">tbody</span><span class="p">&gt;</span>
                                    <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>Current Stock Overview<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
                                    <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span> {% for stock in data %}
                                    <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>{{ stock[0] }}<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;user-subhead&quot;</span><span class="p">&gt;</span>{{ stock[1] }}<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>{{ stock[3] }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>{{ stock[4] }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>
                                            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;{% if stock[2]==&#39;Sold&#39; %} label label-default {% else %} label label-success {% endif %}&quot;</span><span class="p">&gt;</span>{{ stock[2] }}<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
                                        <span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>{{ stock[5] }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>{{ stock[8] }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
                                        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>
                                            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;{% if stock[9] &gt;= 0 %} label label-success {% else %} label label-danger {% endif %}&quot;</span><span class="p">&gt;</span>{{ stock[10] }} ({{ stock[7] }})<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
                                        <span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
                                    <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
                                    {% endfor %}
                                <span class="p">&lt;/</span><span class="nt">tbody</span><span class="p">&gt;</span>
                            <span class="p">&lt;/</span><span class="nt">table</span><span class="p">&gt;</span>
                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;http://code.jquery.com/jquery-1.10.2.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;http://netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>


<p>As you can see, the HTML file has some strange content: these are Jinja variables and loops/statements. Read more at <a href="https://jinja.palletsprojects.com/en/2.11.x/">Jinja's website</a> on how this exactly works.</p>
<h2>Lets have a look at the python code!</h2>
<p>The <strong>script.py</strong> file contains of 2 parts: A Flask endpoint, and the <strong>auth_with_gsheet()</strong> function defined in <a href="https://python-everything.com/post/95/A-customised-application-to-track-your-investments%21.html">our last blog post</a>:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">gspread</span>
<span class="kn">from</span> <span class="nn">oauth2client.service_account</span> <span class="kn">import</span> <span class="n">ServiceAccountCredentials</span>

<span class="k">def</span> <span class="nf">auth_with_gsheet</span><span class="p">():</span>
    <span class="n">scope</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;https://www.googleapis.com/auth/drive&#39;</span><span class="p">]</span>
    <span class="n">credentials</span> <span class="o">=</span> <span class="n">ServiceAccountCredentials</span><span class="o">.</span><span class="n">from_json_keyfile_name</span><span class="p">(</span><span class="s1">&#39;Path/To/credentials.json&#39;</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gspread</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">credentials</span><span class="p">)</span>
</code></pre></div>


<p>Next to this, the flask endpoint is made with following template:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; logic for the webpage here &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>


<p>For the webpage, we need to fetch the data from our sheet:</p>
<div class="codehilite"><pre><span></span><code><span class="n">client</span> <span class="o">=</span> <span class="n">auth_with_gsheet</span><span class="p">()</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;Investment_sheet&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">worksheet</span><span class="p">(</span><span class="s1">&#39;Overview&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">get_all_values</span><span class="p">()</span>
</code></pre></div>


<p>Furthermore, we have to make some adjustments for each row. Therefore, we loop over the <strong>data</strong> list, skipping the first row (these are headers):</p>
<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adjustments come here&quot;&quot;&quot;</span>
</code></pre></div>


<p>The first thing we need to do, is convert strings like '$1,513.20' and '134' to floats and integers:</p>
<div class="codehilite"><pre><span></span><code><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
</code></pre></div>


<p>Next to this, we would like to determine the total investment (Bought Value * Quantity Bought), convert the profit margin to a float value, and datermine the current value of the stocks:</p>
<div class="codehilite"><pre><span></span><code><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">],</span><span class="mi">2</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>
<span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div>


<p>Putting this all together in our flask endpoint:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span>
<span class="kn">import</span> <span class="nn">gspread</span>
<span class="kn">from</span> <span class="nn">oauth2client.service_account</span> <span class="kn">import</span> <span class="n">ServiceAccountCredentials</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">auth_with_gsheet</span><span class="p">():</span>
    <span class="n">scope</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;https://www.googleapis.com/auth/drive&#39;</span><span class="p">]</span>
    <span class="n">credentials</span> <span class="o">=</span> <span class="n">ServiceAccountCredentials</span><span class="o">.</span><span class="n">from_json_keyfile_name</span><span class="p">(</span><span class="s1">&#39;Path/To/credentials.json&#39;</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gspread</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">credentials</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">auth_with_gsheet</span><span class="p">()</span>
    <span class="n">sheet</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;Investment_sheet&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">worksheet</span><span class="p">(</span><span class="s1">&#39;Overview&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">get_all_values</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">],</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>
            <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</code></pre></div>


<p>This will create a view with a list of lists, containing information about our investments. Lets run the webpage:</p>
<div class="codehilite"><pre><span></span><code><span class="nb">export</span> <span class="nv">FLASK_APP</span><span class="o">=</span>script.py
flask run
</code></pre></div>


<p>And go to <strong>http://localhost:5000/</strong> to see our result. It should like like <a href="/examples/investment-application.html">this page</a>.</p>
<p><img alt="Investment Application Example" src="https://python-everything.com/static/blogpost_content/Investment_application/investment_application_front_end_layout.png" /></p>
<p>Using Google Sheets as a back-end database for your application is not the best idea if you look at performance. The good thing is that is is very easy to set up, and to use as a quick prototype. If you'd like to really do something with this application, I would suggest to put it in a SQL database, and add/remove stocks with a new Flask endpoint, which creates a <strong>INSERT</strong> SQL statement.</p>
<p>You can also find this project on my <a href="https://github.com/Lindsen13/Investment-Application">Github</a> account.</p></p>
                </div>
                <div class="col-md-4 sidebar">
                    <div class="sidebar-box">
                        <h3>Create a custom view on top of your Google Sheets Application!</h3>
                        <img src="/static/img/blogposts/105.png" alt="Image" class="round-image img-fluid">
                        <p><p>Using <strong>Flask</strong>, <strong>Google Sheets</strong> and <strong>Yahoo Finance</strong> to create a custom web page for your <strong>Investment portfolio</strong>!</p></p>
                    </div>
                    <div class="sidebar-box">
                        <div class="categories">
                            <h3>Latest posts</h3>
                            
                            <li><a href="/post/158/Scheduling-python-scripts-without-the-use-a-Cloud-Computer-Vendor.html">Scheduling python scripts without the use a Cloud Computer Vendor</a></li>
                            
                            <li><a href="/post/157/Showing-Github-contributions-in-a-simple-chart.html">Showing Github contributions in a simple chart</a></li>
                            
                            <li><a href="/post/141/Extending-my-temperature-tracking-with-Python.html">Extending my temperature tracking with Python</a></li>
                            
                        </div>
                    </div>
                    <div class="sidebar-box">
                        <h3>Python Everything</h3>
                        <p>We at Python Everything try to provide you with your daily Python inspiration! Our post are ment to inspire you and ensure that you start coding in Python yourself.</p>
                        <p><a href="/about.html" class="btn btn-primary btn-sm">Read More</a></p>
                    </div>
                    <!--
                    <div class="sidebar-box">
                        <h3>Paragraph</h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ducimus itaque, autem necessitatibus voluptate quod mollitia delectus aut, sunt placeat nam vero culpa sapiente consectetur similique, inventore eos fugit cupiditate numquam!</p>
                    </div>
                    -->
                </div>
            </div>
        </div>
    </section>

</main>



    <!-- ======= Footer ======= -->
    <footer class="footer" role="contentinfo">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4 mb-md-0">
                    <h3>About Python Everything</h3>
                    <p>We're python enthousiasts, who want to ensure you are getting the same smile on you face everytime your python script runs successfully.</p>
                </div>
                <div class="col-md-7 ml-auto">
                    <div class="row site-section pt-0">
                        <div class="col-md-4 mb-4 mb-md-0">
                            <h3>Navigation</h3>
                            <ul class="list-unstyled">
                                <li><a href="/">Home</a></li>
                                <li><a href="/explore/1.html">Expore</a></li>
                                <li><a href="/#contact">Get in touch</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row justify-content-center text-center">
                <div class="col-md-7">
                    <p class="copyright">&copy; Copyright Python Everything. All Rights Reserved</p>
                    <div class="credits">
                        Designed by <a href="/">Python Everything</a>
                    </div>
                </div>
            </div>

        </div>
    </footer>

    <a href="#" class="back-to-top"><i class="icofont-simple-up"></i></a>

    <!-- Vendor JS Files -->
    <script src="/static/vendor/jquery/jquery.min.js"></script>
    <script src="/static/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/static/vendor/jquery.easing/jquery.easing.min.js"></script>
    <script src="/static/vendor/aos/aos.js"></script>
    <script src="/static/vendor/owl.carousel/owl.carousel.min.js"></script>
    <script src="/static/vendor/jquery-sticky/jquery.sticky.js"></script>

    <!-- Template Main JS File -->
    <script src="/static/js/main.js"></script>

</body>

</html>