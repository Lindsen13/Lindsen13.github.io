<!DOCTYPE html>
<html lang="en">
 

<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-149203155-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-149203155-2');
    </script>
    <!-- Favicons -->

    <link href="/static/img/favicon/android-chrome-512x512.png" rel="icon">
    <link href="/static/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="/static/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/vendor/markdown-converter/styles.css" rel="stylesheet">

    <link href="/static/vendor/icofont/icofont.min.css" rel="stylesheet">
    <link href="/static/vendor/aos/aos.css" rel="stylesheet">
    <link href="/static/vendor/line-awesome/css/line-awesome.min.css" rel="stylesheet">
    <link href="/static/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Template Main CSS File -->
    <link href="/static/css/style.css" rel="stylesheet">

    <meta name="robots" content="index, follow">

    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport"> 
<title>Python Everything - A customised application to track your investments!</title>
<meta name="description" content="Using Python to scrape Yahoo-Finance and populate Google Sheets to track Stock values - In one of my blogposts, I explain &lt;a href=&#34;https://python-everything.com/post..."> 
</head>

<body>

    <!-- ======= Mobile Menu ======= -->
    <div class="site-mobile-menu site-navbar-target">
        <div class="site-mobile-menu-header">
            <div class="site-mobile-menu-close mt-3">
                <span class="icofont-close js-menu-toggle"></span>
            </div>
        </div>
        <div class="site-mobile-menu-body"></div>
    </div>

    <!-- ======= Header ======= -->
    <header class="site-navbar js-sticky-header site-navbar-target" role="banner">

        <div class="container">
            <div class="row align-items-center">

                <div class="col-6 col-lg-2">
                    <h1 class="mb-0 site-logo"><a href="/" class="mb-0">Python Everything</a></h1>
                </div>

                <div class="col-12 col-md-10 d-none d-lg-block">
                    <nav class="site-navigation position-relative text-right" role="navigation">

                        <ul class="site-menu main-menu js-clone-nav mr-auto d-none d-lg-block">
                            <li class="active"><a href="/" class="nav-link">Home</a></li>
                            <li><a href="/explore/1.html" class="nav-link">Explore</a></li>
                            <li><a href="/authors.html" class="nav-link">Collaborators</a></li>
                            <li><a href="/#contact" class="nav-link">Get in touch</a></li>
                        </ul>
                    </nav>
                </div>

                <div class="col-6 d-inline-block d-lg-none ml-md-0 py-3" style="position: relative; top: 3px;">

                    <a href="#" class="burger site-menu-toggle js-menu-toggle" data-toggle="collapse" data-target="#main-navbar">
                        <span></span>
                    </a>
                </div>

            </div>
        </div>

    </header>

    

<main id="main">

    <section class="hero-section inner-page">
        <div class="wave">

            <svg width="1920px" height="265px" viewBox="0 0 1920 265" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <g id="Apple-TV" transform="translate(0.000000, -402.000000)" fill="#FFFFFF">
              <path d="M0,439.134243 C175.04074,464.89273 327.944386,477.771974 458.710937,477.771974 C654.860765,477.771974 870.645295,442.632362 1205.9828,410.192501 C1429.54114,388.565926 1667.54687,411.092417 1920,477.771974 L1920,667 L1017.15166,667 L0,667 L0,439.134243 Z" id="Path"></path>
            </g>
          </g>
        </svg>

        </div>

        <div class="container">
            <div class="row align-items-center">
                <div class="col-12">
                    <div class="row justify-content-center">
                        <div class="col-md-10 text-center hero-text">
                            <h1 data-aos="fade-up" data-aos-delay=""><h1>A customised application to track your investments!</h1></h1>
                            <p class="mb-5" data-aos="fade-up" data-aos-delay="100">2020-08-29 &bullet; By <a href="#" class="text-white">Ivo</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </section>

    <section class="site-section mb-4">
        <div class="container">
            <div class="row">
                <div class="col-md-8 blog-content">

                    <p class="lead mb-5"><p>Using <strong>Python</strong> to scrape <strong>Yahoo-Finance</strong> and populate <strong>Google Sheets</strong> to track <strong>Stock</strong> values</p></p>
                    <p><p>In one of my blogposts, I explain <a href="https://python-everything.com/post/87/Google-Sheets-%26-Python:-How-to-read%2C-change-and-add-data%21.html">how to read and edit Google Sheets with python</a>. Afterwards, I even used Google Sheets as <a href="https://python-everything.com/post/88/Google-Sheets-as-a-backend-process-for-our-SEO-research-tool%21.html">a back-end service for a small SEO tool</a>. In this blogpost, I will explain how I use Google sheets and Python to track some of my stocks.</p>
<p>I have a Google Sheets where I put all the stocks in which I have and used to have. A simplified version looks like this:</p>
<p><img alt="Stock example sheet" src="https://python-everything.com/static/blogpost_content/yahoo_finance_google_sheets/google_sheet_layout_with_stock_info.png" /></p>
<p>Since I will deploy this script to <a href="https://python-everything.com/post/81/ETL-Part-III---Schedule-with-AWS-Lambda.html">AWS Lambda</a>, I will make sure to use a virtual environment.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># create a directory called &#39;investmenttracker&#39;</span>
mkdir investmenttracker
<span class="c1"># Navigate into the directory</span>
<span class="nb">cd</span> investmenttracker
<span class="c1"># Create a virtual environment</span>
python3 -m venv env
<span class="c1"># Activate the virtual environment</span>
<span class="nb">source</span> env/bin/activate
<span class="c1"># Install the &#39;Requests&#39; package.</span>
pip install requests
<span class="c1"># Install the &#39;Pandas&#39; package.</span>
pip install pandas
<span class="c1"># Install the &#39;BeautifulSoup4&#39; package.</span>
pip install BeautifulSoup4
<span class="c1"># Install the &#39;gspread&#39; package.</span>
pip install gspread
<span class="c1"># Install the &#39;oauth2client&#39; package.</span>
pip install oauth2client
<span class="c1"># Create a python file for the script</span>
touch script.py
</code></pre></div>


<p>As you can see above, we will need to call quite some dependencies. Lets import them in our <strong>script.py</strong> file:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">gspread</span>
<span class="kn">from</span> <span class="nn">oauth2client.service_account</span> <span class="kn">import</span> <span class="n">ServiceAccountCredentials</span>
</code></pre></div>


<p>First of all, we need a function that returns the value of a given stock. We will scrape <a href="https://finance.yahoo.com/">Yahoo Finance</a> for this. Yahoo's pages list the stockprice for a stock with the class value <strong>Trsdu(0.3s) Fw(b) Fz(36px) Mb(-4px) D(ib)</strong>, which makes it easy for use to scrape with BeautifulSoup!</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_stock_value</span><span class="p">(</span><span class="n">stock</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://finance.yahoo.com/quote/</span><span class="si">{</span><span class="n">stock</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
    <span class="n">price</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">class_</span><span class="o">=</span><span class="s1">&#39;Trsdu(0.3s) Fw(b) Fz(36px) Mb(-4px) D(ib)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">price</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">price</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S.</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;stock&#39;</span><span class="p">:</span><span class="n">stock</span><span class="p">,</span><span class="s1">&#39;price&#39;</span><span class="p">:</span><span class="n">price</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="n">time</span><span class="p">}</span>
</code></pre></div>


<p>The <strong>get_stock_value()</strong> function returns a dictionary with the stock name, it's price and when the data is retrieved.</p>
<p>Furthermore, we need a function that can authenticate with Google Sheets. I basically copied it from my <a href="https://python-everything.com/post/87/Google-Sheets-%26-Python:-How-to-read%2C-change-and-add-data%21.html">other blog post</a>.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">auth_with_gsheet</span><span class="p">():</span>
    <span class="n">scope</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;https://www.googleapis.com/auth/drive&#39;</span><span class="p">]</span>
    <span class="n">credentials</span> <span class="o">=</span> <span class="n">ServiceAccountCredentials</span><span class="o">.</span><span class="n">from_json_keyfile_name</span><span class="p">(</span><span class="s1">&#39;path/to/credentials.json&#39;</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gspread</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">credentials</span><span class="p">)</span>
</code></pre></div>


<p>Note that we use the <strong>credentials.json</strong> file retrieved from Google, and we have shared the worksheet we want to edit with the email address from this file as well. If you'd like to know how to do this exactly, read my post <a href="https://python-everything.com/post/87/Google-Sheets-%26-Python:-How-to-read%2C-change-and-add-data%21.html">about this</a>. With the authentication in place, and a function defined to retrieve the value of a stock, we can combine it with our Google Sheet that contains information about our current stocks.</p>
<div class="codehilite"><pre><span></span><code><span class="n">client</span> <span class="o">=</span> <span class="n">auth_with_gsheet</span><span class="p">()</span>
</code></pre></div>


<p>This will return a <strong>gspread</strong> object which allows us to read in worksheets and their respective data</p>
<div class="codehilite"><pre><span></span><code><span class="n">sheet</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;Name_Of_Workbook&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">worksheet</span><span class="p">(</span><span class="s1">&#39;Name_of_Sheet&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">get_all_values</span><span class="p">()</span>
</code></pre></div>


<p>This will read in the specified workbook and sheet, and reads all the data. We need Panda's <strong>DateFrame</strong> method to convert the output to a data frame.</p>
<div class="codehilite"><pre><span></span><code><span class="n">headers</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</code></pre></div>


<p>We now need to get each row of the data frame and update the <strong>Value</strong> column for all <strong>Active</strong> (meaning: non-sold) stocks. To do so, we make a loop, and fetch the stock name (note, that the stock name needs to be identical as known at Yahoo, because we will use it in the URL for our <strong>get_stock_value()</strong> function).</p>
<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Active&#39;</span><span class="p">:</span>
        <span class="n">stock</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot;Stock&quot;</span><span class="p">]</span>
</code></pre></div>


<p>We are now only looking at row 3 and 4, which are our active stocks. Lets retrieve the value for each of the stock, print it, and update the <strong>value</strong> column.</p>
<div class="codehilite"><pre><span></span><code><span class="n">stock_info</span> <span class="o">=</span> <span class="n">get_stock_value</span><span class="p">(</span><span class="n">stock</span><span class="o">=</span><span class="n">stock</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stock_info</span><span class="p">)</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">update_cell</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">stock_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">))</span>
</code></pre></div>


<p>Now we have all the building blocks for our final function:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_sheet</span><span class="p">():</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">auth_with_gsheet</span><span class="p">()</span>
    <span class="n">sheet</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;Name_Of_Workbook&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">worksheet</span><span class="p">(</span><span class="s1">&#39;Name_of_Sheet&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">get_all_values</span><span class="p">()</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Active&#39;</span><span class="p">:</span>
            <span class="n">stock</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot;Stock&quot;</span><span class="p">]</span>
            <span class="n">stock_info</span> <span class="o">=</span> <span class="n">get_stock_value</span><span class="p">(</span><span class="n">stock</span><span class="o">=</span><span class="n">stock</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">stock_info</span><span class="p">)</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">update_cell</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">stock_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">))</span>
</code></pre></div>


<p>This script will authenticate with Google Sheets, Read in the data, Scrape Yahoo finance based on the stock's name, and input the value retrieved from Yahoo. The complete script:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">gspread</span>
<span class="kn">from</span> <span class="nn">oauth2client.service_account</span> <span class="kn">import</span> <span class="n">ServiceAccountCredentials</span>

<span class="k">def</span> <span class="nf">get_stock_value</span><span class="p">(</span><span class="n">stock</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://finance.yahoo.com/quote/</span><span class="si">{</span><span class="n">stock</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
    <span class="n">price</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">class_</span><span class="o">=</span><span class="s1">&#39;Trsdu(0.3s) Fw(b) Fz(36px) Mb(-4px) D(ib)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">price</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">price</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S.</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;stock&#39;</span><span class="p">:</span><span class="n">stock</span><span class="p">,</span><span class="s1">&#39;price&#39;</span><span class="p">:</span><span class="n">price</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="n">time</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">auth_with_gsheet</span><span class="p">():</span>
    <span class="n">scope</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;https://www.googleapis.com/auth/drive&#39;</span><span class="p">]</span>
    <span class="n">credentials</span> <span class="o">=</span> <span class="n">ServiceAccountCredentials</span><span class="o">.</span><span class="n">from_json_keyfile_name</span><span class="p">(</span><span class="s1">&#39;path/to/credentials.json&#39;</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gspread</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">credentials</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update_sheet</span><span class="p">():</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">auth_with_gsheet</span><span class="p">()</span>
    <span class="n">sheet</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;Copy of Investments_2.0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">worksheet</span><span class="p">(</span><span class="s1">&#39;Overview&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">get_all_values</span><span class="p">()</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Active&#39;</span><span class="p">:</span>
            <span class="n">stock</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot;Stock&quot;</span><span class="p">]</span>
            <span class="n">stock_info</span> <span class="o">=</span> <span class="n">get_stock_value</span><span class="p">(</span><span class="n">stock</span><span class="o">=</span><span class="n">stock</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">stock_info</span><span class="p">)</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">update_cell</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">stock_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">update_sheet</span><span class="p">()</span>
</code></pre></div>


<p>You can also find the code on my <a href="https://github.com/Lindsen13/Yahoo_Finance_To_Google_sheets">Github</a> account.</p></p>
                </div>
                <div class="col-md-4 sidebar">
                    <div class="sidebar-box">
                        <h3>A customised application to track your investments!</h3>
                        <img src="/static/img/blogposts/95.png" alt="Image" class="round-image img-fluid">
                        <p><p>Using <strong>Python</strong> to scrape <strong>Yahoo-Finance</strong> and populate <strong>Google Sheets</strong> to track <strong>Stock</strong> values</p></p>
                    </div>
                    <div class="sidebar-box">
                        <div class="categories">
                            <h3>Latest posts</h3>
                            
                            <li><a href="/post/157/Showing-Github-contributions-in-a-simple-chart.html">Showing Github contributions in a simple chart</a></li>
                            
                            <li><a href="/post/141/Extending-my-temperature-tracking-with-Python.html">Extending my temperature tracking with Python</a></li>
                            
                            <li><a href="/post/140/A-simple-dashboard-based-on-the-data-from-my-Arduino-project.html">A simple dashboard based on the data from my Arduino project</a></li>
                            
                        </div>
                    </div>
                    <div class="sidebar-box">
                        <h3>Python Everything</h3>
                        <p>We at Python Everything try to provide you with your daily Python inspiration! Our post are ment to inspire you and ensure that you start coding in Python yourself.</p>
                        <p><a href="/about.html" class="btn btn-primary btn-sm">Read More</a></p>
                    </div>
                    <!--
                    <div class="sidebar-box">
                        <h3>Paragraph</h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ducimus itaque, autem necessitatibus voluptate quod mollitia delectus aut, sunt placeat nam vero culpa sapiente consectetur similique, inventore eos fugit cupiditate numquam!</p>
                    </div>
                    -->
                </div>
            </div>
        </div>
    </section>

</main>



    <!-- ======= Footer ======= -->
    <footer class="footer" role="contentinfo">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4 mb-md-0">
                    <h3>About Python Everything</h3>
                    <p>We're python enthousiasts, who want to ensure you are getting the same smile on you face everytime your python script runs successfully.</p>
                </div>
                <div class="col-md-7 ml-auto">
                    <div class="row site-section pt-0">
                        <div class="col-md-4 mb-4 mb-md-0">
                            <h3>Navigation</h3>
                            <ul class="list-unstyled">
                                <li><a href="/">Home</a></li>
                                <li><a href="/explore/1.html">Expore</a></li>
                                <li><a href="/#contact">Get in touch</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row justify-content-center text-center">
                <div class="col-md-7">
                    <p class="copyright">&copy; Copyright Python Everything. All Rights Reserved</p>
                    <div class="credits">
                        Designed by <a href="/">Python Everything</a>
                    </div>
                </div>
            </div>

        </div>
    </footer>

    <a href="#" class="back-to-top"><i class="icofont-simple-up"></i></a>

    <!-- Vendor JS Files -->
    <script src="/static/vendor/jquery/jquery.min.js"></script>
    <script src="/static/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/static/vendor/jquery.easing/jquery.easing.min.js"></script>
    <script src="/static/vendor/aos/aos.js"></script>
    <script src="/static/vendor/owl.carousel/owl.carousel.min.js"></script>
    <script src="/static/vendor/jquery-sticky/jquery.sticky.js"></script>

    <!-- Template Main JS File -->
    <script src="/static/js/main.js"></script>

</body>

</html>